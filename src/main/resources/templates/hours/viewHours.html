<#import "/main_layout.html" as layout />

<@layout.stdpage "Hours Served" "hoursStyle.css" "hours/servantHrsList.js">

<div id ="mainContainer" class="container">
	
	<!--  this container holds onto all information regarding Stats and has the button as well located at the bottom -->	
	<!-- hide hour stat div from admins -->
	<#if !userAdmin>
	<div class="row" style="padding-left: 30px; padding-bottom: 30px">
		
		<div class="row" style="padding-left: 20px; padding-bottom: 20px">
			<div>
				<h2>Service Stats</h2>
			</div>
		</div>
					
		<!-- container thats creating a table that will hold our data-->
		<div class="row">
			<table class="table table-striped ui-widget ui-widget-content table-bordered table-hover">
				<thead>
					<tr class="ui-widget-header">
						<th>Hours Served This Semester</th>
						<th class="wtTh">${semTot!"UNKNOWN"}</th>
						<th>Hours Served This Term</th>
						<th class="wtTh">${termTot!"UNKNOWN"}</th>
						<th>Organizations Helped</th>
						<th class="wtTh">${totOrgs!"UNKNOWN"}</th>
						<th>Average Hours Served per Month</th>
						<th class="wtTh">${avgPerMo!"UNKNOWN"}</th>
					</tr>
				</thead>
			</table>
		</div>
	</div>
	</#if>					
					

	<div class="row" style="padding-left: 20px; padding-bottom: 20px">
	
		<!-- Button that prompts the user to enter their service hours -->
		<div class="col">
			<button type="button" class="btn btn-md btn-dark addBtn" style="padding-top:10px">
				<span class="fas fa-plus-circle"></span> Add Hours
			</button>
		</div>
		
		<!-- Combo box for filtering hours by sponsor (service client) -->
		<div class="col text-right comboBox">
			<label>By Sponsor</label>
			<select id="scComboBox" data-prev-selected="${selectedScid}" onchange="if(this.value != 0) { queryUrl(this.id, this.value) } else { removeQueryUrl(this.id) }">
				<option value='0'>List All</option>
				
				<#list sClients as sc>
					<#if sc.scid == selectedScid>
						<option value="${sc.scid}" selected="selected">${sc.name}</option>
					<#else>
						<option value="${sc.scid}">${sc.name}</option>
					</#if>
				</#list>
			</select>
		</div>
		
		<div class="col text-right comboBox">
			<label>By Month:</label>
			<select id="monthComboBox" data-prev-selected="${selectedMonth}"  onchange="if(this.value != 0) { queryUrl(this.id, this.value) } else { removeQueryUrl(this.id) }">
			</select>		
		</div>
		
	</div>
	<div class="row text-right" style="padding-bottom: 20px">
		<!-- Clears all filters -->
		<div class="col">
			<button id="btnClearFilters" class="btn btn-md addBtn" type="button"
				onclick="baseUrl()">
				Clear All Filters</button>
		</div>
	</div>
	
	<!-- Service Hours table -->
	<div class="row" style="padding-left: 20px; padding-bottom: 20px; padding-top: 20px">
		<div class="col">
			<table id="hrs_tbl"	class="table table-striped table-bordered table-sm" style="width: 100%">
				<thead>
					<tr>
						<th class="th-sm">ID</th>
						<th class="th-sm">Service Event</th>
						<th class="th-sm">Hours Served</th>
						<th class="th-sm">Status</th>
						<th class="th-sm">Action</th>
					</tr>
				</thead>
				<tbody id="hrs_tbl_body">
					<#if hours??>
					<#list hours as hrs>
						<tr id="row${hrs.shid?c}">
							<td class='hrRow' onRowClick="${hrs.shid?c}" name='hrs_id'>${hrs.shid!"UNKOWN"}</td>
							<td class='hrRow' onRowClick="${hrs.shid?c}" name='hrs_eventName'>${hrs.event.title!"UNKNOWN"}</td>
							<td class='hrRow' onRowClick="${hrs.shid?c}" name='hrs_hrsServed'>${hrs.hours!"UNKNOWN"}</td>
							<td class='hrRow' onRowClick="${hrs.shid?c}" name='hrs_status'>${hrs.status!"UNKNOWN"}</td>
							
							<!-- action buttons: edit/delete -->
							<td class="hrActions">
								<#if hrs.status != "Approved">
									<button type="button" class="btnHrEdit edit btn" onEditClick="${hrs.shid?c}">
										<i class="fas fa-pencil-alt"></i> 
									</button>
				   					<button type="button" class=" btnHrDel del btn" onDelClick="${hrs.shid?c}">
										<i class="fas fa-trash-alt"></i>  
									</button>
								</#if>
							</td>
						</tr>
					</#list>
					</#if>
				</tbody>
			</table>
		</div>
	</div>
</div>



	<!-- back button -->
	<div class="row" style="padding-left: 20px; padding-bottom: 20px">
		<button onclick="goBack()" class="btn edit">
			<span class="fas fa-arrow-left"></span> Back
		</button>
	</div>
	
<!-- The div below defines the delete dialog for deleting a served hour which is hidden by JS and exposed by JQ. -->
<div id="delDlg" title="DELETE SELECTED HOURS" class="ui-widget delWid">
	<p id="del_confirm">
			Are you sure you want to delete this service hour? <br />
		</p>
		
		<div id="delShId">Id</div>
		<div id="delEvTitle">Event Title</div>
		<div id="delHrsSrved">hrs srved</div>
		<div id="delStatus">status</div>
		
</div>

<!--  The div below shows a modal view of the service hour information (contact, date, etc) when the row was selected -->
<div id="viewDlg" title="Service Hour Details" class="ui-widget">
	<#include "/hours/hourDetails.html"/>
</div>

<div id="addDlg" title="Add Service Hour" class="ui-widget">
	<#include "/hours/addHours.html"/>
</div>

<!--  The div below defines the edit dialog for updating a served hour which is hidden by JS and exposed by JQ. -->
<div id="editDlg" title="Edit Service Hour" class="ui-widget">
	<#include "/hours/editHours.html"/>
</div>

<div id="dlgEvSel" title="Select Event..." style="display:none">

	<div class="row" style="padding-left: 20px; padding-bottom: 20px">
		
		<div class="col">
			<!-- Events table -->
			<table id="tblEvents"
				class="table table-striped table-bordered table-sm" cellspacing="0"
				width="100%">
				<thead>
					<!-- these columns are not final. If anyone thinks different information would be better
				feel free to change these -->
					<tr>
						<th class="th-sm">&#xA0;</th>
						<th class="th-sm">Id</th>
						<th class="th-sm">Title</th>
						<th class="th-sm">Date</th>
					</tr>
				</thead>
				<tbody>
					<#list events as ev>
					<tr id="eid-${ev.eid?c}">
						<td class="ev_sel"><input class="boxSel" type="checkbox" eid="${ev.eid}" /></td>
						<td class="ev_id">${ev.eid!"UNKNOWN"}</td>
						<td class="ev_title">${ev.title!"UNKNOWN"}</td>
						<td class="ev_date">${ev.date?datetime}</td>
					</tr>
					</#list>
				</tbody>
			</table>
		</div>
	</div>
</div>

<script src="/srv/js/datatables.min.js"></script>
<link rel="stylesheet" href="/srv/css_style/datatables.min.css" />

</@layout.stdpage>

